{% trans_default_domain 'NIPAProjetBundle' %}

{% block body %}   


    {# TEST LES DROITS USER#}
    {% set droit = 0 %}
    {% for groupe in user.getGroupesToArray() %} 
        {% if groupe.getPermission() %} {# Test si le groupe a des permissions #}
            {% if (groupe.getPermission().getCMSProjet() == 1) %} {# Si oui on test les droits d'accès #}
                {% set droit = droit + 1 %}  
            {% endif %}    
        {% endif %}
    {% endfor %}      
    
        <h4 class=""><span class='glyphicon glyphicon-list-alt'></span> {{ 'En réalisation'|trans }} </h4>        
 
        <div class="container">                   
            <div class="row col-md-13">

                <!-- PANEL(s) En Réalisation -->      
                
                    {% for phase in listProjetPhaseEtapeRealisation %}

                            <div class="panel panel-info" id="GDP">
                                <div class="panel-heading" id="GDP">
                                    <h5 class="panel-title"> Informations liées à la phase <strong> {{ phase.getNom()}} </strong></h5>
                                    <div class="pull-right">
                                        <strong> OK/NOK </strong>
                                        <span data-toggle="collapse" data-target="#collapseInfo{{ phase.getNom() }}" class="clickable collapsed" title="Afficher détails" data-container="body">
                                            <i class="glyphicon glyphicon-plus"></i>
                                        </span>
                                    </div>                      
                                </div>
                                {% if listProjetPhaseEtapeRealisation|length == 1 %}            
                                    <div id="collapseInfo{{ phase.getNom() }}" class="panel-collapse collapse in"> 
                                {% else %}
                                    <div id="collapseInfo{{ phase.getNom() }}" class="panel-collapse collapse"> 
                                {% endif %}
                                    <div class="panel-body">

                                        <table class="table table-hover" id="champs-table GDP">
                                            <thead>
                                                <tr>
                                                    <th class="text-center">Date Prév.</th>
                                                    <th class="text-center">Date Rév.</th>
                                                    <th class="text-center">Validation</th>
                                                    <th class="text-center">Remarques</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><input type="text" class="form-control input-md date textinput" id="datePrev{{ phase.getNom() }}" class="datePrev{{ phase.getNom() }}" name="datePrev{{ phase.getNom() }}" style="text-align:center;"></td>
                                                    <td><input type="text" class="form-control input-md date textinput" id="dateRev{{ phase.getNom() }}" class="dateRev{{ phase.getNom() }}" name="dateRev{{ phase.getNom() }}" style="text-align:center;"></td>
                                                    <td class="text-center"><input id="validation{{ phase.getNom() }}{{ phase.getNom() }}" name="validation" type="checkbox" value=""></td>
                                                    <td class="text-center"><textarea class="form-control input-md" rows="2" cols="50" id="remarques{{ phase.getNom() }}" placeholder="..." name="remarques{{ phase.getNom() }}"></textarea></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div> 
                                </div>                    
                            </div> 

                            <br>     

                        <script>

                        $('#datePrev{{ phase.getNom() }}').datetimepicker({
                        todayBtn:"true",
                        format:"dd/mm/yyyy", 
                        autoclose:"true",
                        startView:"year",
                        minView:"month",
                        language:"fr"
                        });  

                        $('#dateRev{{ phase.getNom() }}').datetimepicker({
                        todayBtn:"true",
                        format:"dd/mm/yyyy", 
                        autoclose:"true",
                        startView:"year",
                        minView:"month",
                        language:"fr"
                        });  
                        
                        </script>    
                        
                    {% endfor %}
                
            </div>
        </div> 
        
        <div class="pull-right">
            {% if droit != 0 %}
                <button class="btn btn-success" type="submit"><span class='glyphicon glyphicon-check'></span> Valider</button>           
            {% else %}
                <button class="btn btn-success" type="submit" DISABLED><span class='glyphicon glyphicon-check'></span> Valider</button>           
            {% endif %}
        </div> 
                                
                    
{% endblock %}            